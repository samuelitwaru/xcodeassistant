import{u as te,Q,R as ve}from"./QBtn.5b322f3a.js";import{Q as pe,a as he}from"./QHeader.8c5c66ac.js";import{a as be,b as xe,Q as E}from"./QIcon.5fefd665.js";import{c as $,f as _e,h as Se}from"./render.88e06a72.js";import{f as _,h as g,n as ae,T as ye,a7 as we,t as k,k as N,B,a8 as ke,g as Ie,N as Te,Y as qe,a9 as Le,r as G,o as y,c as A,w as r,d as i,Z as V,F as O,_ as Z,D,E as R,a as L,H as P,$ as J,a0 as W,aa as Ce}from"./index.8354598b.js";import{u as Me,f as Qe,g as Ae,b as ne,d as j,c as q,Q as De,a as X,e as Be}from"./QDrawer.611fe888.js";import{a as Fe,Q as Oe}from"./QCard.12da5a58.js";import{Q as z}from"./QSeparator.648571ed.js";import{u as Ee,a as He}from"./use-dark.bbfff598.js";import{u as Ne,a as Ve}from"./use-id.9e99cdc6.js";import{Q as Re,a as Pe}from"./QLayout.6df44e6e.js";import{api as I}from"./axios.04ca824a.js";import{_ as je}from"./plugin-vue_export-helper.21dcd24c.js";import"./dom.e258fbd2.js";var ze=$({name:"QAvatar",props:{...be,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:l}){const x=xe(e),t=_(()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(e.square===!0?" q-avatar--square":e.rounded===!0?" rounded-borders":"")),v=_(()=>e.fontSize?{fontSize:e.fontSize}:null);return()=>{const s=e.icon!==void 0?[g(E,{name:e.icon})]:void 0;return g("div",{class:t.value,style:x.value},[g("div",{class:"q-avatar__content row flex-center overflow-hidden",style:v.value},_e(l.default,s))])}}}),$e=$({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:l,emit:x}){let t=!1,v,s,u=null,c=null,a,f;function h(){v&&v(),v=null,t=!1,u!==null&&(clearTimeout(u),u=null),c!==null&&(clearTimeout(c),c=null),s!==void 0&&s.removeEventListener("transitionend",a),a=null}function p(o,b,d){b!==void 0&&(o.style.height=`${b}px`),o.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,t=!0,v=d}function S(o,b){o.style.overflowY=null,o.style.height=null,o.style.transition=null,h(),b!==f&&x(b)}function C(o,b){let d=0;s=o,t===!0?(h(),d=o.offsetHeight===o.scrollHeight?0:void 0):(f="hide",o.style.overflowY="hidden"),p(o,d,b),u=setTimeout(()=>{u=null,o.style.height=`${o.scrollHeight}px`,a=m=>{c=null,(Object(m)!==m||m.target===o)&&S(o,"show")},o.addEventListener("transitionend",a),c=setTimeout(a,e.duration*1.1)},100)}function M(o,b){let d;s=o,t===!0?h():(f="show",o.style.overflowY="hidden",d=o.scrollHeight),p(o,d,b),u=setTimeout(()=>{u=null,o.style.height=0,a=m=>{c=null,(Object(m)!==m||m.target===o)&&S(o,"hide")},o.addEventListener("transitionend",a),c=setTimeout(a,e.duration*1.1)},100)}return ae(()=>{t===!0&&h()}),()=>g(ye,{css:!1,appear:e.appear,onEnter:C,onLeave:M},l.default)}});const T=we({}),Ke=Object.keys(te);var ee=$({name:"QExpansionItem",props:{...te,...Me,...Ee,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...Qe,"click","afterShow","afterHide"],setup(e,{slots:l,emit:x}){const{proxy:{$q:t}}=Ie(),v=He(e,t),s=k(e.modelValue!==null?e.modelValue:e.defaultOpened),u=k(null),c=Ne(),{show:a,hide:f,toggle:h}=Ae({showing:s});let p,S;const C=_(()=>`q-expansion-item q-item-type q-expansion-item--${s.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),M=_(()=>{if(e.contentInsetLevel===void 0)return null;const n=t.lang.rtl===!0?"Right":"Left";return{["padding"+n]:e.contentInsetLevel*56+"px"}}),o=_(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),b=_(()=>{const n={};return Ke.forEach(w=>{n[w]=e[w]}),n}),d=_(()=>o.value===!0||e.expandIconToggle!==!0),m=_(()=>e.expandedIcon!==void 0&&s.value===!0?e.expandedIcon:e.expandIcon||t.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),H=_(()=>e.disable!==!0&&(o.value===!0||e.expandIconToggle===!0)),oe=_(()=>({expanded:s.value===!0,detailsId:c.value,toggle:h,show:a,hide:f})),K=_(()=>{const n=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:t.lang.label[s.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":s.value===!0?"true":"false","aria-controls":c.value,"aria-label":n}});N(()=>e.group,n=>{S!==void 0&&S(),n!==void 0&&Y()});function le(n){o.value!==!0&&h(n),x("click",n)}function ie(n){n.keyCode===13&&U(n,!0)}function U(n,w){w!==!0&&u.value!==null&&u.value.focus(),h(n),Te(n)}function re(){x("afterShow")}function de(){x("afterHide")}function Y(){p===void 0&&(p=Ve()),s.value===!0&&(T[e.group]=p);const n=N(s,F=>{F===!0?T[e.group]=p:T[e.group]===p&&delete T[e.group]}),w=N(()=>T[e.group],(F,ge)=>{ge===p&&F!==void 0&&F!==p&&f()});S=()=>{n(),w(),T[e.group]===p&&delete T[e.group],S=void 0}}function se(){const n={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},w=[g(E,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&s.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:m.value})];return H.value===!0&&(Object.assign(n,{tabindex:0,...K.value,onClick:U,onKeyup:ie}),w.unshift(g("div",{ref:u,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),g(q,n,()=>w)}function ue(){let n;return l.header!==void 0?n=[].concat(l.header(oe.value)):(n=[g(q,()=>[g(j,{lines:e.labelLines},()=>e.label||""),e.caption?g(j,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&n[e.switchToggleSide===!0?"push":"unshift"](g(q,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>g(E,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&n[e.switchToggleSide===!0?"unshift":"push"](se()),n}function ce(){const n={ref:"item",style:e.headerStyle,class:e.headerClass,dark:v.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return d.value===!0&&(n.clickable=!0,n.onClick=le,Object.assign(n,o.value===!0?b.value:K.value)),g(ne,n,ue)}function fe(){return B(g("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:M.value,id:c.value},Se(l.default)),[[ke,s.value]])}function me(){const n=[ce(),g($e,{duration:e.duration,onShow:re,onHide:de},fe)];return e.expandSeparator===!0&&n.push(g(z,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:v.value}),g(z,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:v.value})),n}return e.group!==void 0&&Y(),ae(()=>{S!==void 0&&S()}),()=>g("div",{class:C.value},[g("div",{class:"q-expansion-item__container relative-position"},me())])}});const Ue={name:"MyLayout",setup(){const e=k(!1);k("");const l=qe(),x=Le();function t(){e.value=!e.value}const v=k({}),s=k([]),u={name:""},c=k({model:[],app:l.params.app_id}),a=k({name:""}),f=_(()=>s.value.filter(d=>{var m;return!((m=v.value.models)!=null&&m.map(H=>H.model).includes(d.id))}));function h(){I.get(`apps/${l.params.app_id}/`).then(d=>{v.value=d.data,console.log(v.value)})}function p(){I.get("models/").then(d=>{s.value=d.data})}function S(){I.post("models/",u).then(d=>{p(),u.name=""})}function C(){console.log(a.value),a.value.app_model=l.params.model_id,I.post("app-model-fields/",a.value).then(d=>{h(),a.value.name=""})}function M(){c.value.model=c.value.model[0];var d=s.value.filter(m=>m.id==c.value.model)[0];c.value.name=d.name,c.value.plural=d.plural,I.post("app-models/",c.value).then(m=>{x.push(`/apps/${v.value.id}`),h(),u.name=""})}function o(d){I.delete(`/app-models/${d}/`).then(m=>{m.status==204&&(h(),p(),x.push(`/apps/${l.params.app_id}/`))})}function b(d){I.delete(`/app-model-fields/${d}/`).then(m=>{m.status==204&&(h(),p(),x.push(`/apps/${appModel.app}/`))})}return h(),p(),{app:v,freeModels:f,leftDrawerOpen:e,formData:u,appModelFormData:c,fieldFormData:a,toggleLeftDrawer:t,createModel:S,createAppModel:M,createField:C,deleteAppModel:o,deleteAppModelField:b}}},Ye={class:"row items-center"},Ge={class:"q-pa-sm",align:"center"},Ze={class:"q-ma-sm",align:"center"},Je=["value"];function We(e,l,x,t,v,s){const u=G("router-link"),c=G("router-view");return y(),A(Re,{view:"hHh lpR fFf",class:"bg-grey-1"},{default:r(()=>[i(he,{class:"border-bottom bg-white text-grey-8 q-py-xs","height-hint":"58"},{default:r(()=>[i(u,{to:"/apps"},{default:r(()=>[i(Q,{flat:"",dense:"",round:"",onClick:t.toggleLeftDrawer,"aria-label":"Menu",icon:"arrow_back"},null,8,["onClick"])]),_:1}),i(Q,{flat:"",dense:"",round:"",onClick:t.toggleLeftDrawer,"aria-label":"Menu",icon:"menu"},null,8,["onClick"]),i(u,{to:`/apps/${e.$route.params.app_id}`},{default:r(()=>[e.$q.screen.gt.xs?(y(),A(Q,{key:0,flat:"","no-caps":"","no-wrap":"",class:"q-ml-xs"},{default:r(()=>[i(pe,{shrink:"",class:"text-weight-bold"},{default:r(()=>[V(O(t.app.name),1)]),_:1})]),_:1})):Z("",!0)]),_:1},8,["to"])]),_:1}),i(Be,{modelValue:t.leftDrawerOpen,"onUpdate:modelValue":l[8]||(l[8]=a=>t.leftDrawerOpen=a),"show-if-above":"",bordered:"",class:"bg-grey-2",width:300},{default:r(()=>[i(De,{class:"fit"},{default:r(()=>[i(X,null,{default:r(()=>[(y(!0),D(P,null,R(t.app.models,a=>(y(),A(u,{key:a,to:`/apps/${e.$route.params.app_id}/models/${a.id}`},{default:r(()=>[i(ee,{group:"somegroup",dense:"","dense-toggle":"","expand-separator":"",icon:"fa fa-cube",label:a.name,"header-class":"text-primary","default-opened":a.id==e.$route.params.model_id},{header:r(()=>[i(q,null,{default:r(()=>[L("div",null,[i(ze,{icon:"fa fa-cube"}),V(" "+O(a.name),1)])]),_:2},1024),i(q,{side:""},{default:r(()=>[L("div",Ye,[i(Q,{flat:"",color:"red",dense:"",icon:"mdi-trash-can",onClick:f=>t.deleteAppModel(a.id)},null,8,["onClick"])])]),_:2},1024)]),default:r(()=>[i(Fe,null,{default:r(()=>[i(Oe,{class:"py-1"},{default:r(()=>[i(X,null,{default:r(()=>[(y(!0),D(P,null,R(a.app_model_fields,f=>(y(),A(u,{key:f,to:`/apps/${e.$route.params.app_id}/models/${a.id}/fields/${f.id}`},{default:r(()=>[B((y(),A(ne,{clickable:"",active:e.$route.params.field_id==f.id,"active-class":"menu-item-active",class:"text-red q-my-xs"},{default:r(()=>[i(q,{avatar:""},{default:r(()=>[i(E,{name:"fa fa-atom"})]),_:1}),i(q,null,{default:r(()=>[i(j,null,{default:r(()=>[V(O(f.name),1)]),_:2},1024)]),_:2},1024),i(Q,{flat:"",color:"red",dense:"",icon:"close",onClick:h=>t.deleteAppModelField(f.id)},null,8,["onClick"])]),_:2},1032,["active"])),[[ve]])]),_:2},1032,["to"]))),128)),L("div",Ge,[B(L("input",{onBlur:l[0]||(l[0]=(...f)=>t.createField&&t.createField(...f)),onKeyup:l[1]||(l[1]=W((...f)=>t.createField&&t.createField(...f),["enter"])),"onUpdate:modelValue":l[2]||(l[2]=f=>t.fieldFormData.name=f),type:"text",placeholder:"new field"},null,544),[[J,t.fieldFormData.name]])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["label","default-opened"]),i(z)]),_:2},1032,["to"]))),128)),i(ee,{group:"somegroup",dense:"",label:"Add Model"},{header:r(()=>[B(L("input",{onBlur:l[3]||(l[3]=(...a)=>t.createModel&&t.createModel(...a)),onKeyup:l[4]||(l[4]=W((...a)=>t.createModel&&t.createModel(...a),["enter"])),"onUpdate:modelValue":l[5]||(l[5]=a=>t.formData.name=a),type:"text",placeholder:"new model"},null,544),[[J,t.formData.name]])]),default:r(()=>[L("div",Ze,[t.freeModels.length?B((y(),D("select",{key:0,id:"cars",name:"cars",multiple:"",style:{width:"10.5rem","overflow-y":"auto"},onDblclick:l[6]||(l[6]=(...a)=>t.createAppModel&&t.createAppModel(...a)),"onUpdate:modelValue":l[7]||(l[7]=a=>t.appModelFormData.model=a)},[(y(!0),D(P,null,R(t.freeModels,a=>(y(),D("option",{key:a,option:"",value:a.id},O(a.name),9,Je))),128))],544)),[[Ce,t.appModelFormData.model]]):Z("",!0)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(Pe,null,{default:r(()=>[i(c)]),_:1})]),_:1})}var mt=je(Ue,[["render",We]]);export{mt as default};
